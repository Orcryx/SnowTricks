{% extends 'base.html.twig' %}

{% block title %}Modifier le Trick
{% endblock %}

{% block zoneOne %}
	<div id="zoneOne">
		<div class="hero-picture">
			{% if form.picture.vars.data|length > 0 %}
				<img src="{{ form.picture.vars.data[0].src }}" alt="Image principale du trick">
				<button class="edit-btn">
					<i class="fa fa-pen"></i>
				</button>
				<button class="delete-btn">
					<i class="fa fa-trash"></i>
				</button>
			{% endif %}
			<div class="hero-text grand-text ombre">
				<h1>{{ trick.name }}</h1>
			</div>
		</div>

		<div id="formulaire">
			<div id="formTrick" class="flex-column">
				<h1>Editer un Trick</h1>
				<div class="form-error">
					{{ form_errors(form) }}
				</div>
				<div id="carrousel" class="flex">
					<ul class="picture" data-index="{{ form.picture|length > 0 ? form.picture|last.vars.name + 1 : 0 }}" data-prototype="{{ form_widget(form.picture.vars.prototype)|e('html_attr') }}">
						{% for picture in form.picture %}
							<div class="card picture-data">
								<img src="{{ picture.vars.data.src }}" alt="Image du trick">
								{{ form_row(picture.src) }}
							</div>
						{% endfor %}
					</ul>
					<ul class="video" data-index="{{ form.video|length > 0 ? form.video|last.vars.name + 1 : 0 }}" data-prototype="{{ form_widget(form.video.vars.prototype)|e('html_attr') }}">
						{% for video in form.video %}
							<div class="card">
								{% if "youtube.com" in video.vars.data.src or "youtu.be" in video.vars.data.src %}
									<a href="{{ video.vars.data.src }}" target="_blank">
										<img class="video" src="https://img.youtube.com/vi/{{ video.vars.data.src | split('?v=') | last | split('&') | first }}/hqdefault.jpg" alt="Vidéo YouTube">
									</a>
								{% else %}
									<video controls width="250">
										<source src="{{ video.vars.data.src }}" type="video/mp4">
										{{ form_row(video.src) }}
									</video>
								{% endif %}
							</ul>
						</div>
					{% endfor %}
				</div>
				<button type="button" class="add_item_link" data-collection-holder-class="picture">Ajouter une image</button>
				<button type="button" class="add_item_link" data-collection-holder-class="video">Ajouter une video</button>

				{{ form_start(form , {'method': 'POST'}) }}
				{{ form_row(form.name) }}
				{{ form_row(form.description, {'attr': {'class': 'large-textarea'}}) }}
				{{ form_row(form.category) }}


				<div class="flex">
					<a href="{{ path('app_trick_remove', {slug: trick.slug}) }}" onclick="return confirm('Êtes-vous sûr de vouloir supprimer ce trick ? Cette action est irréversible.')" class="btn btn-danger">Supprimer</a>
					<a type="submit" class="btn btn-primary">Sauvegarder</a>
				</div>
				{{ form_end(form, {"render_rest": false}) }}
			</div>
		</div>
	</div>
	<script src="{{ asset('js/MoreAssetTricks.js') }}"></script>
{% endblock %}
